
DUGL Player 0.5 - released 2011-03-25
============================================

About
-----

DUGL Player is a GUI video player for DOS systems.

License
-------

DUGL Player is (C) by FFK. This a freeware, use it at your own risk.
Source code of player itself is available (C/C++/Assembly language)
and source code/binaries of DUGL+ and binaries of DUGL Core can be
downloaded separately from DUGL website.
The player uses external libraries LibOGG, LibVorbis and LibTheora
by Xiph Foundation, source code is available under the BSD-like Xiph
license and an updated version of Berkley MPEG1/2 decoder library.
The player is redistribuable, the relevant files
(main executable, support files, this file, source)
should be kept together, but there is no need to include the libraries
or example videos.

You can use/reuse/modify source code if "DUGL Player" or part of it 
at the following conditions :
1) Don't pretend that you made it or hold copyright over it.
2) Tell some where on your documentation that you used "Dugl Player" 
   sources with a reference to DUGL website: currently dugl.50webs.com


System requirements
-------------------

- DOS
- CPU with MMX support, minimum frequency for playing in real time
  depends from played file, especially video frame size and rate,
  for 640x480 OGG Theora at 30 fps with Vorbis sound 1 GHz is required
- Graphics card with VESA 2.0 support
- Optional Mouse and driver (CTmouse from FreeDOS, Logitech driver, ...)

Features
--------

- Playing video files with or without sound
- Nice GUI, control by mouse(optional) or keyboard, built-in screenshot feature

Supported media fileformats
---------------------------

- OGG container with Theora video and Vorbis audio codec, or just one
  of them (FLAC audio and Dirac video not supported)

- VCD, SVCD, DVD, MPEG1 and MPEG2 video files with or without sound.
 
(see below for details and rationale)

Usage
-----

Run the executable. Optionally a filename to be played can be specified
in the commandline.

Keyboard shortcuts
------------------

- Alt+X : Exit immediately
- Alt+S : Save a BMP screenshot
- Alt+P : Start/Restart playing current video 
- Space+Tab : Pause/continue playing
- Space+Enter : Switch between full screen and GUI mode
- F2  : Enable/Disable Interpolating UV (better quality/slower)
- F3  : Show open dialog
- F4  : Close current video file
- F5  : Enable/Disable video smoothing (full screen mode)
- F6  : Enable/Disable Display FPS (full screen mode)
- F7  : Enable/Disable Display Time (full screen mode)
- F8  : Enable/Disable Vertical sync
- F9  : Enable/Disable Video looping
- F10 : Enable/Disable Frame dropping
- F11 : Enable/Disable Fit screen

Files of the package
--------------------

DUGLPLAY.EXE      main executable
DUGLPLAY.CFG      dugl player configure file.
HELLO.CHR         FONT file
AZERTFR.MAP       Keyboard map
GFX/LICENSE.BMP   (required)
GFX/PCONT.BMP     (required)
GFX/PLAY.BMP      (required)
GFX/SHUT.BMP      (required)
GFX/MOUSEIMG.GIF  (required)
DUGLPLAY.TXT      this text
DUGLPLAY.CC       main C++ source code
YUV2RGB.ASM       YUV2RGB conversion assembly MMX routines

Performance tuning and "MTRR-hack"
----------------------------------

Playing video is a time consuming task, including file I/O, video
decoding, colorspace conversion, writing to video RAM, and if sound is
present additionally audio decoding. A sufficiently fast CPU is required
(see above) to play in real time. There are a few possibilities to tune
the performance:
- If your BIOS doesn't use DMA, install a DMA driver (XDMA, UIDE or
  similar). This can significantly reduce the time wasted in file I/O.
- To further speed up the file I/O, you can copy the video file into
  a RAM disk, however the space is limited and enough RAM must be left
  free for DUGL Player.
- If your CPU supports "MTRR write combining" (99% of MMX capable CPU's
  do), enable it. DUGL Player will do this itself only if it runs in
  Ring0. You can use the "VESAMTRR" tool by Japheth from his "HXGUI.ZIP"
  package to do this setting in advance. This can significantly speed up
  the write access to video RAM, the effect holds until a CPU reset.
- Disable "Interpolate UV" (F2) can give a speed up for less good image
  quality in some cases.
- Disable "Smoothing" (F5) give a good speed improvement but worst 
  image quality specially for up-sampled videos.
- Disable "VSynch" (F8) 
- With F10 you can enable or disable frame dropping if your CPU is too
  slow. If enabled the video will play in real time but loose frames
  - it will "jump", if the CPU is far insufficient, you won't see
  (almost) anything from your video. If disabled you will see all frames
  but playing will be slow.

Screenshots
-----------

It is possible to save a screenshot of played video or any screen scene
at any time with Alt+S. Up to 9 shots can be saved, named
starting at "DUGLPLYR.BMP", into current directory. The saving occurs
immediately without any dialog or error reports on failure.

Missing features & Wishlist
---------------------------

(sorted by priority)

0. Sound driver support: PCI Intel ICH and PCI Intel HDA, or ISA SB 16
   and ISA SB Pro sound card or chip [big work]
1. Playing sound (Vorbis and WAV) [medium difficulty]
2. Multiple file masx [rather easy]
3. CPU usage indicator [medium difficulty]
4. Playing YUV4MPEG, also at same time with a WAV audio file
   [medium difficulty]
5. Sound suspend if video is delayed [medium difficulty]
6. Remove the need of support files or at least reduce the amount of
   them [medium difficulty]
7. Video seeking
8. Playing large videos at full res: currently such videos are
    downsampled to 640x480
9. Support FLAC audio (raw and inside OGG)
10. Support 32 bpp
11. Enable MTRR hack also if not in Ring0.

Why support or not what media file formats
------------------------------------------

+ Theora: see below

+ YUV4MPEG: is a simple lossless format, and an output option for MPLAYER
  ("-vo yuv4mpeg"). Also commandline encoders and decoders for various
  codecs use it as the uncompressed video format. Note that decoding
  into this format will increase the file size by factor cca 10 ... 100
  compared to the compressed size.

+ WAV: despite its flaws, a simple and the most popular uncompressed
  audio format.

- Dirac: this video codec is very expensive (CPU performance) and its
  popularity is very low so far.

- Proprietary video codecs: huge amount of them (+ subversions), legal
  issues (patents, restrictive GPL license of alternative open source
  implementations).

- FLAC as audio codec inside OGG together with Theora is "valid", but
  not very popular and not very suitable (FLAC is lossless, Theora
  lossy and "lower bitrate" category)

- Other audio formats and codecs: covered by MPXPLAY audio player, risk
  of legal issues with the proprietary ones.

Why support Theora
------------------

Theora is the (almost) only one free software and patent-free video
codec. The reference implementation achieved version 1.0 end of 2008,
and during 2009 it was upgraded to 1.1 improving the efficiency which
was previously inferior compared to other (proprietary) codecs. The
popularity of Theora was low in the past, but now it is finally "ready
for use", and supported in Firefox browser since version 3.5 for online
viewing, and the amount of videos in this format around is increasing.
Thus DUGL Player is part of the "move" away from proprietary video
technologies to free ones.

Where to get / store videos in Theora format
--------------------------------------------

At the Xiph wiki there is a list
"http://wiki.xiph.org/..." of websites providing videos in OGG Theora
format for download, among them a few offering also hosting of such
files.

How to create videos in Theora format
-------------------------------------

There are various encoders available, what should be noted that the old
ones (before middle of 2009) are inferior in quality, and those before
Theora 1.0 can produce is some cases even incorrect output playing
wrongly (ugly green stripes for example).

- FFMPEG2THEORA - preferred and the pretty most "official" one, a Win32
  commandline binary exists and runs with HX DOS Extender (2009-08-31
  or newer). Transcodes almost anything into Theora (with Vorbis sound
  if sound present in the input).

- APEG encoder - a simple DOS GUI encoder+player, regrettably uses an
  old pre-1.0 Theora version

- FFMPEG - the binary compiled from the FFMPEG library can also encode
  Theora, one problem is that the audio codec defaults to FLAC (this can
  be overridden by a commandline switch), the other one is that the
  Theora support is "external" and not well supported - it may work or
  not (garbage output or crash). Some DOS binaries from beginning 2008
  are around, thus pre-1.0 Theora again.

Compiling the source
--------------------

You can compile DUGL Player (except the DUGL Core module) yourself.

Tools needed:

- DGJPP
- YASM

Source and library files:

- "DUGLPLAY.CC", "YUV2RGB.ASM" (included in the package)
- DUGL Core 1.16+ and DUGL Plus 0.31+ libraries from "http://dugl.50webs.com"
- LibOGG, LibVorbis and LibTheora from "http://xiph.org"
- LibBMEG 1.0+ improved Berkley mpeg1/2 library, can be downloaded separetely.

Places of interest
------------------

- "http://dugl.50webs.com" - project page of DUGL library and
  DUGL Player

- "http://xiph.org" - the home of LibOGG, LibVorbis and LibTheora used
  in DUGL Player

- "http://japheth.de" - the home of HX DOS Extender, allowing to run
  many Win32 commandline tools like FFMPEG2THEORA in DOS, including
  the VESAMTRR tool and the DPMI host HDPMI32

- "http://unet.univie.ac.at/~a0503736/php/drdoswiki/index.php?n=Mai
  n.Mediaplayers" - information about other DOS audio and video players,
  as well as DOS in general at other pages of the DOS Wiki, the main
  page is "http://drdos.org"

Contact the author
------------------

Feedback is welcome: bug reports, success reports, suggestions,
contributions, etc. You can contact the author at the forum linked from
the project page "http://dugl.50webs.com" or the "BTTR" DOS forum.

EOD
===

